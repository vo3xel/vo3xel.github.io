(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{179:function(e,t,n){e.exports=n.p+"static/media/axes.ab1f88a8.mtl"},181:function(e,t,n){e.exports=n.p+"static/media/axes.d0ed0548.obj"},182:function(e,t,n){e.exports=n.p+"static/media/cube.41d3f142.obj"},183:function(e,t,n){e.exports=n.p+"static/media/pyramid.b5a2d763.obj"},186:function(e,t,n){e.exports=n.p+"static/media/53418.9892a59f.svg"},193:function(e,t,n){e.exports=n(483)},275:function(e,t,n){},277:function(e,t,n){},483:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),l=n(33),r=n.n(l),i=(n(275),n(68)),c=n(69),d=n(71),s=n(70),m=n(72),u=(n(277),n(0)),f=n(177),p=n.n(f),h=n(178),E=n.n(h),v=n(179),C=n.n(v),k=n(180),b=n.n(k),w=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(d.a)(this,Object(s.a)(t).call(this,e)))._onAnimate=function(){n.controls.update()},n.state={scene:{},model:n.props.model,material:C.a},console.log("(OBJScene) -> "+n.state.model),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this.refs.scene,t=new b.a(this.refs.mainCamera,r.a.findDOMNode(this.refs.react3));this.controls=t;var n=new u.PointLight(16777215,1,100);this.refs.mainCamera.add(n),this.setState({scene:e})}},{key:"componentWillUnmount",value:function(){this.controls.dispose(),delete this.controls}},{key:"render",value:function(){var e=window.innerWidth,t=window.innerHeight;return o.a.createElement(p.a,{mainCamera:"camera",width:e-100,height:t-100,ref:"react3",onAnimate:this._onAnimate},o.a.createElement("scene",{ref:"scene",fog:new u.Fog},o.a.createElement("perspectiveCamera",{key:"perspectiveCamera",name:"camera",fov:50,aspect:e/t,near:.5,far:1e3,ref:"mainCamera",position:new u.Vector3(0,10,10),lookAt:new u.Vector3(0,0,0)}),o.a.createElement("group",{name:"objectGroup",ref:"objgroup"},o.a.createElement(E.a,{name:"model",model:this.state.model,material:this.state.Material,scene:this.state.scene,group:"objectGroup"}))))}}]),t}(o.a.Component),M=n(181),g=n.n(M),F=n(182),N=n.n(F),j=n(183),O=n.n(j),y=n(184),x=n(185),U=n(186),B=n.n(U),S=n(187),J=n(191),L=n(192),A=n.n(L);y(u);var R=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(d.a)(this,Object(s.a)(t).call(this,e))).onOpenModal=function(){n.setState({open:!0})},n.onCloseModal=function(){n.setState({open:!1}),n.setState({fileUploadError:!1})},n.THREE=u,n.objLoader=new n.THREE.OBJLoader,n.state={model:null,open:!1,modelFileUploaded:null,uploadedModelFileName:"Custom model"},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"exportOBJToFile",value:function(e){var t=e.positions.map(function(e){return"v "+e[0].toLocaleString("fullwide",{useGrouping:!1,minimumFractionDigits:6}).replace(",",".")+" "+e[1].toLocaleString("fullwide",{useGrouping:!1,minimumFractionDigits:6}).replace(",",".")+" "+e[2].toLocaleString("fullwide",{useGrouping:!1,minimumFractionDigits:6}).replace(",",".")}),n=e.cells.map(function(e){return"f "+(e[0]+1)+" "+(e[1]+1)+" "+(e[2]+1)+" "+(e[3]+1)}),a=new Blob([t.join("\n")+"\n"+n.join("\n")],{type:"text/plain"});return URL.createObjectURL(a)}},{key:"importOBJFromFile",value:function(e){return new Promise(function(t,n){fetch(e).then(function(e){return e.text()}).then(function(e){var n={},a=e.match(/^v( -?\d+(\.\d+)?){3}$/gm);a&&(n.vertices=a.map(function(e){var t=e.split(" ");return(t=t.map(function(e){return parseFloat(e)})).shift(),t}));var o=e.match(/^vn( -?\d+(\.\d+)?){3}$/gm);o&&(n.vertexnormals=o.map(function(e){var t=e.split(" ");return t.shift(),t=t.map(function(e){return parseFloat(e)})}));var l=e.match(/^f( \d+\/\/\d+){4}$/gm);l&&(n.faces=l.map(function(e){var t=(e=e.replace(/\/\//g," ")).split(" ");return t.shift(),[Number(t[0])-1,Number(t[2])-1,Number(t[4])-1,Number(t[6])-1]})),t(n)}).catch(function(e){return t(e)})})}},{key:"calculateCatmullClark",value:function(e,t){var n=this;this.importOBJFromFile(e).then(function(e){var a=x(e.vertices,e.faces,t,!1),o=n.exportOBJToFile(a);n.setState({model:o})})}},{key:"handleFileUpload",value:function(e){var t=this;if(e.size/1024/1024>=5)console.error("File too big: > 5MB");else{console.log(e);var n=new FileReader;n.onload=function(a){var o=n.result,l=new Blob([o],{type:"text/plain"}),r=URL.createObjectURL(l);t.setState({modelFileUploaded:r,uploadedModelFileName:e.name},function(){return t.loadModel(4,0)}),t.onCloseModal()},n.readAsText(e)}}},{key:"loadModel",value:function(e,t){var n=this;console.log(e,t),this.setState({model:null},function(){var a={};1===e&&(a=g.a),2===e&&(a=N.a),3===e&&(a=O.a),4===e&&(console.log(n.state.modelFileUploaded),a=n.state.modelFileUploaded),0===t?n.setState({model:a},a=console.log("* "+a)):n.calculateCatmullClark(a,t)})}},{key:"modalError",value:function(){this.setState({fileUploadError:!0})}},{key:"render",value:function(){var e=this,t=this.state.open;return o.a.createElement("div",{className:"App"},o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement("span",{style:{color:"gray"}},"Catmull-Clark demo")),o.a.createElement("li",{className:"dropdown"},o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(1,0)},className:"dropbtn"},"Axis"),o.a.createElement("div",{className:"dropdown-content"},o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(1,1)}},"iteration 1"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(1,2)}},"iteration 2"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(1,3)}},"iteration 3"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(1,4)}},"iteration 4"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(1,5)}},"iteration 5"))),o.a.createElement("li",{className:"dropdown"},o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(2,0)},className:"dropbtn"},"Cube"),o.a.createElement("div",{className:"dropdown-content"},o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(2,1)}},"iteration 1"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(2,2)}},"iteration 2"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(2,3)}},"iteration 3"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(2,4)}},"iteration 4"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(2,5)}},"iteration 5"))),o.a.createElement("li",{className:"dropdown"},o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(3,0)},className:"dropbtn"},"Pyramid"),o.a.createElement("div",{className:"dropdown-content"},o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(3,1)}},"iteration 1"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(3,2)}},"iteration 2"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(3,3)}},"iteration 3"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(3,4)}},"iteration 4"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(3,5)}},"iteration 5"))),this.state.modelFileUploaded?o.a.createElement("li",{className:"dropdown"},o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(4,0)},className:"dropbtn"},this.state.uploadedModelFileName),o.a.createElement("div",{className:"dropdown-content"},o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(4,1)}},"iteration 1"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(4,2)}},"iteration 2"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(4,3)}},"iteration 3"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(4,4)}},"iteration 4"),o.a.createElement("a",{href:"#",onClick:function(){e.loadModel(4,5)}},"iteration 5"))):null,o.a.createElement("li",{className:"dropdown"},o.a.createElement("a",{href:"#",onClick:function(){e.onOpenModal()},className:"dropbtn"},o.a.createElement("img",{src:B.a,style:{width:20,height:20}})))),this.state.model?o.a.createElement(w,{className:"scene",ref:"objscene",model:this.state.model}):null,o.a.createElement(S.a,{open:t,onClose:this.onCloseModal,center:!0},o.a.createElement("center",null,o.a.createElement("h2",null,"Upload OBJ file ( \u2264 5 MB)"),o.a.createElement(J.FilePicker,{extensions:["obj"],maxSize:5,onChange:function(t){return e.handleFileUpload(t)},onError:function(t){return e.modalError()}},o.a.createElement("button",null,"Upload OBJ")))),o.a.createElement(A.a,{left:"650px"}))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(R,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[193,2,1]]]);
//# sourceMappingURL=main.101d5a7d.chunk.js.map